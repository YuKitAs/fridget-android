\documentclass[a4paper]{scrreprt}

\usepackage[german]{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{ae}
\usepackage[bookmarks,bookmarksnumbered]{hyperref}
\usepackage{tocbasic}
\usepackage{longtable}

\begin{document}
    \chapter{RESTful API}
    \section{Authentifizierung mithilfe der Google APIs}
    Die Authentifizierung bei Fridget wird mithilfe von Google Sign-In für Android realisiert. Dabei sendet der Client beim Anmelden mit Google Account einen ID-Token, welchen er vom Googleserver erhält, zu dem Fridget-Server per HTTPS POST. Dort wird die Integrität des Tokens mithilfe von GoogleTokenVerifier geprüft. Danach werden die Benutzerinformationen aus dem Token vom Fridget-Server benutzt, um eine Session aufzubauen oder einen neuen Benutzer in der Datenbank zu speichern.
    
    \newpage
    \section{HTTP-Protokoll}
    Folgende REST Endpoints verwenden wir für die Kommunikation zwischen Client und Server:
	\begin{flushleft}
		\begin{longtable}{|p{.12\textwidth}|p{.48\textwidth}|p{.4\textwidth}|}
		\hline
		\textbf{HTTP Methode} & \textbf{Endpoint} & \textbf{Beschreibung} \\
		\hline
		\multicolumn{3}{|l|} {FlatshareController} \\
		\hline
		GET & /flatshares/\{id\} & WG beitreten \\
		POST & /flatshares & WG erstellen \\ 
		\hline
		\multicolumn{3}{|l|}{AccessCodeController} \\
		\hline
		POST & /access-codes & Zugangscode anfordern \\ \hline
		\multicolumn{3}{|l|}{User} \\
		\hline
		POST & /users & Anmelden \\
		\hline
		\multicolumn{3}{|l|}{Device} \\
		\hline
		POST & /devices & App-Instanz-ID speichern \\
		\hline
		\multicolumn{3}{|l|}{MembershipController} \\
		\hline
		GET & /memberships/users?flatshare=\{id\} & Mitglieder ansehen \\
		GET & /memberships?flatshare=\{fid\}\&user=\{uid\} & Zugeteilte Magnetfarbe anfordern \\
		POST & /memberships & WG beitreten (mit Zugangscode) \\
		DELETE & /memberships?flatshare=\{fid\}\&user=\{uid\} & WG verlassen \\
		\hline
		\multicolumn{3}{|l|}{CoolNoteController} \\
		\hline
		GET & /cool-notes?flatshare=\{id\} & Cool Notes aktualisieren \\
		GET & /cool-notes/\{id\} & Großansicht einer Cool Note ansehen \\
		POST & /cool-notes & Cool Note erstellen \\
		DELETE & /cool-notes/\{id\} & Cool Note löschen \\
		\hline
		\multicolumn{3}{|l|}{FrozenNoteController} \\
		\hline
		GET & /frozen-notes?flatshare=\{id\} & Frozen Notes aktualisieren \\
		GET & /frozen-notes/\{id\} & Großansicht einer Frozen Note ansehen \\
		PUT & /frozen-notes/\{id\} & Frozen Note bearbeiten \\
		\hline
		\multicolumn{3}{|l|}{ImageNoteController*} \\
		\hline
		GET & /image-notes?flatshare=\{id\} & Image Cool Notes aktualisieren \\
		GET & /image-notes/\{id\} & Großansicht einer Image Cool Note ansehen \\
		POST & /image-notes & Image Cool Note erstellen \\
		DELETE & /image-notes/\{id\} & Image Cool Note löschen \\
		\hline	
		\multicolumn{3}{|l|}{ReadConfirmationController} \\
		\hline
		GET & /read-confirmations/users?cool-note=\{id\} & Leser einer Cool Note ansehen \\
		POST & /read-confirmations & ``I have seen this''-Checkbox markieren \\
		DELETE & /read-confirmations?cool-note=\{cid\}\&user=\{uid\} & ``I have seen this''-Checkbox unmarkieren \\
		\hline
		\multicolumn{3}{|l|}{CommentController*} \\
		\hline
		GET & /comments?cool-note=\{cid\} & Kommentare einer Cool Note ansehen \\
		POST & /comments & Kommentar schreiben \\
		DELETE & /comments/\{id\} & Kommentar löschen \\
		\hline
		\end{longtable}
	\end{flushleft}
	* Wunschkriterien
	
	\newpage
	\section{HTTP-Statuscodes}
	Folgende Statuscodes liefern wir intern bei der HTTP-Antwort auf jede HTTP-Anfrage:
	\begin{flushleft}
		\begin{tabular}{|p{.15\textwidth}|p{.3\textwidth}|p{.55\textwidth}|}
		\hline
		\textbf{Code} & \textbf{Nachricht} & \textbf{Bedeutung} \\
		\hline
		\multicolumn{3}{|l|}{Erfolgreiche Operation} \\
		\hline
		200 & OK & Die Anfrage wurde erfolgreich bearbeitet und das Ergebnis der Anfrage wird in der Antwort übertragen. \\
		201 & Created & Die Anfrage wurde erfolgreich bearbeitet. Die angeforderte Ressource wurde vor dem Senden der Antwort erstellt. \\
		204 & No Content & Die Anfrage wurde erfolgreich durchgeführt, die Antwort enthält jedoch bewusst keine Daten. \\
		\hline
		\multicolumn{3}{|l|}{Client-Fehler} \\
		\hline
		400 & Bad Request & Die Anfrage-Nachricht war fehlerhaft aufgebaut. \\
		401 & Unauthorized & Die Anfrage kann nicht ohne gültige Authentifizierung durchgeführt werden. \\
		403 & Forbidden & Die Anfrage wurde mangels Berechtigung des Clients nicht durchgeführt, bspw. weil der authentifizierte Benutzer nicht berechtigt ist. \\
		404 & Not Found & Die angeforderte Ressource wurde nicht gefunden. \\
		422 & Unprocessable Entity & Die Verarbeitung der Anfrage wird z.B. wegen semantischer Fehler abgelehnt. \\
		\hline
		\multicolumn{3}{|l|}{Server-Fehler} \\
		\hline
		500 & Internal Server Error & Dies ist ein „Sammel-Statuscode“ für unerwartete Serverfehler. \\
		\hline	
		\end{tabular}
	\end{flushleft}
\end{document}